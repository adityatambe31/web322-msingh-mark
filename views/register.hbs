<div class="register-container">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow registration-card">
        <div class="card-header bg-primary text-white text-center py-4">
          <h2 class="mb-0"><i class="fas fa-user-plus me-2"></i>Create Your Account</h2>
        </div>
        <div class="card-body p-4">
          
          {{#if errorMessage}}
            <div class="alert alert-danger d-flex align-items-center" role="alert">
              <i class="fas fa-exclamation-circle me-2"></i>
              <div><strong>Error:</strong> {{errorMessage}}</div>
            </div>
          {{/if}}
          
          {{#if successMessage}}
            <div class="alert alert-success d-flex align-items-center" role="alert">
              <i class="fas fa-check-circle me-2"></i>
              <div><strong>Success:</strong> {{successMessage}}</div>
            </div>
            <div class="text-center mt-4">
              <a class="btn btn-success btn-lg" href="/login">
                <i class="fas fa-sign-in-alt me-2"></i>Proceed to Login
              </a>
            </div>
          {{else}}
            <form method="POST" action="/register" class="registration-form">
              <div class="mb-4">
                <label for="userName" class="form-label">Username</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-user"></i></span>
                  <input 
                    type="text" 
                    id="userName" 
                    name="userName" 
                    class="form-control" 
                    placeholder="Choose a username" 
                    value="{{userName}}" 
                    required
                  >
                </div>
                <div class="form-text">Username must be 3-20 characters long.</div>
              </div>
              
              <div class="mb-4">
                <label for="email" class="form-label">Email Address</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                  <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    class="form-control" 
                    placeholder="your@email.com" 
                    value="{{email}}" 
                    required
                  >
                </div>
                <div class="form-text">We'll never share your email with anyone else.</div>
              </div>
              
              <div class="mb-4">
                <label for="password" class="form-label">Password</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <input 
                    type="password" 
                    id="password" 
                    name="password" 
                    class="form-control" 
                    placeholder="Create a password" 
                    required
                  >
                  <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
                <div class="password-strength mt-2">
                  <div class="progress">
                    <div class="progress-bar bg-danger" role="progressbar" style="width: 0%" id="passwordStrength"></div>
                  </div>
                  <small class="password-feedback text-muted">Password strength: <span id="strengthText">Weak</span></small>
                </div>
                <div class="form-text">Must be at least 8 characters with letters, numbers and special characters.</div>
              </div>
              
              <div class="mb-4">
                <label for="password2" class="form-label">Confirm Password</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <input 
                    type="password" 
                    id="password2" 
                    name="password2" 
                    class="form-control" 
                    placeholder="Confirm your password" 
                    required
                  >
                </div>
              </div>
              
              <div class="mb-4">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="termsCheck" required>
                  <label class="form-check-label" for="termsCheck">
                    I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms of Service</a> and <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>
                  </label>
                </div>
              </div>
              
              <div class="d-grid mb-4">
                <button type="submit" class="btn btn-primary btn-lg">
                  <i class="fas fa-user-plus me-2"></i>Create Account
                </button>
              </div>
              
              <div class="text-center">
                <p>Already have an account? <a href="/login" class="text-decoration-none">Log in</a></p>
              </div>
            </form>
          {{/if}}
        </div>
        <div class="card-footer py-3 bg-light text-center">
          <small class="text-muted">By creating an account, you're agreeing to our Customer Terms of Service, Privacy Policy, and Cookie Policy.</small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="termsModalLabel">Terms of Service</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h6>1. Acceptance of Terms</h6>
        <p>By accessing or using Manpreet's Store, you agree to be bound by these Terms of Service.</p>
        
        <h6>2. User Accounts</h6>
        <p>You are responsible for safeguarding your account and maintaining the confidentiality of your password.</p>
        
        <h6>3. User Content</h6>
        <p>You retain ownership of any content you submit to the service.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Privacy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h6>1. Information We Collect</h6>
        <p>We collect information you provide directly to us when you create an account.</p>
        
        <h6>2. How We Use Your Information</h6>
        <p>We use the information we collect to provide, maintain, and improve our services.</p>
        
        <h6>3. Information Sharing</h6>
        <p>We do not share your personal information with third parties without your consent.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
  // Password visibility toggle
  document.getElementById('togglePassword').addEventListener('click', function() {
    const passwordInput = document.getElementById('password');
    const icon = this.querySelector('i');
    
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      icon.classList.remove('fa-eye');
      icon.classList.add('fa-eye-slash');
    } else {
      passwordInput.type = 'password';
      icon.classList.remove('fa-eye-slash');
      icon.classList.add('fa-eye');
    }
  });
  
  // Password strength meter
  document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const progressBar = document.getElementById('passwordStrength');
    const strengthText = document.getElementById('strengthText');
    
    // Simple strength calculation
    let strength = 0;
    if (password.length >= 8) strength += 25;
    if (/[A-Z]/.test(password)) strength += 25;
    if (/[0-9]/.test(password)) strength += 25;
    if (/[^A-Za-z0-9]/.test(password)) strength += 25;
    
    progressBar.style.width = strength + '%';
    
    // Update color and text based on strength
    if (strength <= 25) {
      progressBar.className = 'progress-bar bg-danger';
      strengthText.textContent = 'Weak';
    } else if (strength <= 50) {
      progressBar.className = 'progress-bar bg-warning';
      strengthText.textContent = 'Fair';
    } else if (strength <= 75) {
      progressBar.className = 'progress-bar bg-info';
      strengthText.textContent = 'Good';
    } else {
      progressBar.className = 'progress-bar bg-success';
      strengthText.textContent = 'Strong';
    }
  });
  
  // Password confirmation check
  document.getElementById('password2').addEventListener('input', function() {
    if (this.value !== document.getElementById('password').value) {
      this.setCustomValidity("Passwords don't match");
    } else {
      this.setCustomValidity('');
    }
  });
</script>
